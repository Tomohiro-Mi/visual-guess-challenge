# スコア計算ロジックの説明

## 現在の実装（`game_engine.py` の `calculate_score` メソッド）

### 基本ロジック

```python
def calculate_score(self, elapsed_seconds):
    # 制限時間を超えていたら0点
    if elapsed_seconds >= self.time_limit:
        return 0
    
    if self.time_limit <= 0:
        return 0
    
    # 残り時間の割合をスコアとする (100点満点)
    # 時間経過とともに 100 -> 0 に線形で減少
    ratio_remaining = 1.0 - (elapsed_seconds / self.time_limit)
    score = 100 * ratio_remaining
    
    return max(0, score)
```

### 計算式

**スコア = 100 × (1 - 経過時間 / 制限時間)**

または

**スコア = 100 × (残り時間 / 制限時間)**

### 詳細

1. **制限時間（`time_limit`）**: デフォルトで **30.0秒**
   - この時間内に答えを出せばスコアがもらえる
   - 制限時間を超えると0点

2. **計算方法**:
   - 残り時間の割合を計算
   - その割合に100をかけてスコアにする
   - 線形（比例）で減少

3. **スコアの範囲**: **0点 ～ 100点**

### スコア例（制限時間30秒の場合）

| 経過時間 | 残り時間 | 残り時間の割合 | スコア |
|---------|---------|--------------|--------|
| 0秒     | 30秒    | 100%         | 100点  |
| 5秒     | 25秒    | 83.3%        | 83.3点 |
| 10秒    | 20秒    | 66.7%        | 66.7点 |
| 15秒    | 15秒    | 50.0%        | 50.0点 |
| 20秒    | 10秒    | 33.3%        | 33.3点 |
| 25秒    | 5秒     | 16.7%        | 16.7点 |
| 30秒以上 | 0秒     | 0%           | 0点    |

### グラフで見る

```
スコア
100 |*
    |  *
    |    *
 50 |      *
    |        *
    |          *
  0 |____________*__________> 経過時間
    0         15         30秒
```

### 特徴

- ✅ **シンプル**: 残り時間に比例してスコアが決まる
- ✅ **直感的**: 早く答えるほど高得点
- ✅ **上限あり**: 最大100点、最小0点

### 使用箇所

- **正解時のみ**: 不正解の場合は0点（`score = 0.0`）
- **セッション管理**: 各問題のスコアを配列に保存し、合計・平均を計算
- **表示**: 問題ごとのスコア、セッション累計スコア、平均スコアを表示

### 変更のポイント

もしスコア計算ロジックを変更する場合、以下のような変更が考えられます：

1. **非線形スコアリング**: 早く答えるほど大きく加点（指数関数的など）
2. **ボーナススコア**: 一定時間内（例：10秒以内）でボーナス加点
3. **段階的減点**: 時間帯ごとに減点率を変える
4. **最小保証点**: たとえ時間ギリギリでも最低点（例：10点）を保証
5. **難易度による調整**: モードごとにスコア倍率を変更

どのように変更したいか教えてください！

