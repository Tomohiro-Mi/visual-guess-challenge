# ラベル管理ガイド

## 概要

このシステムでは、画像ファイル名から正解を自動抽出するのではなく、**手動でラベルファイル（`labels.json`）を編集**して、複数の正解キーワード、カテゴリ、ヒント情報を設定できます。

## ラベルファイルの形式

`labels.json` ファイルは以下の形式で記述します：

```json
{
  "画像ファイル名": {
    "answers": ["正解1", "正解2", "正解3"],
    "category": "カテゴリ名",
    "hint": "ヒントテキスト"
  }
}
```

### フィールドの説明

- **`answers`** (必須): 正解キーワードのリスト。複数の正解を設定できます。
  - 例: `["bird", "鳥", "とり"]`
  - ユーザーがこれらのいずれかを入力すれば正解と判定されます

- **`category`** (オプション): カテゴリ名
  - 例: `"動物"`, `"果物"`, `"食べ物"`, `"乗り物"`
  - ゲーム画面の上部に表示されます

- **`hint`** (オプション): ヒントテキスト
  - 例: `"空を飛ぶ生き物です"`
  - ゲーム画面に表示され、プレイヤーの手がかりになります

## 設定例

### 例1: 基本的な設定（正解のみ）

```json
{
  "a-bird1.jpg": {
    "answers": ["bird", "鳥"]
  }
}
```

### 例2: 完全な設定（カテゴリとヒント付き）

```json
{
  "a-bird1.jpg": {
    "answers": ["bird", "鳥", "とり"],
    "category": "動物",
    "hint": "空を飛ぶ生き物です"
  }
}
```

### 例3: 日本語のみの正解

```json
{
  "m-takoyaki1.jpg": {
    "answers": ["たこ焼き", "タコ焼き", "タコヤキ", "takoyaki"],
    "category": "食べ物",
    "hint": "タコが入った丸い食べ物です"
  }
}
```

## 正解判定の仕組み

- **複数の正解に対応**: `answers` リストのいずれかに一致すれば正解です
- **大文字小文字を区別しない**: "Bird" と "bird" は同じとして扱われます
- **部分一致も対応**: "bird" と入力すれば "bird1" にも一致します（ただし完全一致を推奨）
- **日本語と英語の両方対応**: 日本語と英語の正解を混在できます

## ラベルファイルの編集方法

### 方法1: 手動で編集

1. `labels.json` ファイルをテキストエディタで開く
2. 画像ファイル名と対応するラベル情報を追加・編集
3. JSON形式の構文エラーに注意（カンマ、引用符など）

### 方法2: スクリプトを使用（推奨）

`create_label_template.py` を実行すると、`images` フォルダ内の画像ファイルからテンプレートを生成できます。

```bash
python create_label_template.py
```

これにより、すべての画像ファイルが `labels.json` に追加され、空の `answers` が設定されます。後で手動で編集してください。

## 注意事項

1. **ファイル名の一致**: `labels.json` のキー（画像ファイル名）は、`images` フォルダ内の実際のファイル名と完全に一致させる必要があります
   - ✅ 正しい: `"a-bird1.jpg"`
   - ❌ 間違い: `"images/a-bird1.jpg"` (パスは不要)

2. **JSON構文エラー**: カンマや引用符の付け忘れに注意してください
   - 最後のエントリにはカンマを付けない
   - 文字列は必ずダブルクォート（`"`）で囲む

3. **エンコーディング**: ファイルは UTF-8 エンコーディングで保存してください

4. **ラベルが設定されていない画像**: ラベルが設定されていない画像の場合、システムはファイル名から推測しようとします（フォールバック機能）

## よくある質問

### Q: ラベルファイルを追加・編集した後、すぐに反映されますか？

A: はい。ゲームを再起動するか、新しい画像を読み込むと、最新のラベル情報が読み込まれます。

### Q: 同じ画像ファイルに複数のラベルを設定できますか？

A: いいえ。1つの画像ファイルに対して1つのラベルエントリのみです。ただし、`answers` リストに複数の正解を設定できます。

### Q: ラベルファイルがない場合はどうなりますか？

A: システムはファイル名から推測しようとしますが、正しく動作しない可能性があります。必ずラベルファイルを用意することを推奨します。

## 現在のデータセット

現在の `labels.json` には以下の画像が登録されています：

- **動物** (a-*): bird, cat, dog, horse, rabbit
- **果物** (f-*): grape, lemon, pear, pineapple, strawberry
- **食べ物** (m-*): bread, friedpotato, pizza, riceball, takoyaki
- **乗り物** (v-*): airplane, bus, motorbike, ship, train

各画像には複数の正解キーワード（英語・日本語）が設定されています。

